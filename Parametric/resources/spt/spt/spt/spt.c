////  spt.c//  spt////  Created by rchailan on 24/11/14.////#include "spt.h"#include <stdio.h>#include <stdlib.h> /* for malloc & free */#include <math.h>#include <R.h>//#define CSTACK_DEFNS 7#include <Rinternals.h>#include <R_ext/Arith.h>	/* NA handling */#include <Rmath.h>#include <R_ext/Random.h>	/* ..RNGstate */#include <R_ext/Applic.h>	/* NA handling */#include <omp.h>#define CHUNKSIZE 100void testpwlOpenmp(double *x, double *y, double *nsites, double *ntimes, double *val) {    *val = 0;    int i,j;    for (i = 0; i < *nsites ; i++) {        for (j = 0; j < (*ntimes - 1) ; j++) {            *val += 1;        }    }}void partestpwlOpenmp(double *x, double *y, double *nsites, double *ntimes, double *val) {//    R_CStackLimit=(uintptr_t)-1;        *val = 0;    int chunk,i,j;    int gros = 0;        chunk = CHUNKSIZE;        #pragma omp parallel shared(val,chunk) private(i) reduction(+:gros)    {        #pragma omp for schedule(dynamic,chunk)        for (i = 0; i < (int) *nsites ; i++) {            for (j = 0; j < (int) ( *ntimes -1 ) ; j++) {                gros += 1;            }        }        *val += gros;    }}